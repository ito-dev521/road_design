<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é“è·¯è©³ç´°è¨­è¨ˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div class="app-container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="header">
            <div class="header-left">
                <h1 class="app-title">ğŸ›£ï¸ é“è·¯è©³ç´°è¨­è¨ˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span id="userName">Loading...</span>
                    <span class="user-role" id="userRole"></span>
                </div>
                <a href="admin.html" class="btn btn-info" id="settingsLink">è¨­å®š</a>
                <button class="btn btn-outline" id="logoutBtn">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
            </div>
        </header>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <main class="main-content">
            <!-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé¸æŠ/ä½œæˆã‚¨ãƒªã‚¢ -->
            <section class="project-section">
                <div class="project-header">
                    <h2>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†</h2>
                    <button class="btn btn-primary" id="newProjectBtn">æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</button>
                </div>
                
                <div class="project-selector">
                    <select id="projectSelect" class="project-select">
                        <option value="">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                    </select>
                </div>
            </section>

            <!-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ± -->
            <section class="project-info" id="projectInfo" style="display: none;">
                <div class="project-details">
                    <h3 id="projectName"></h3>
                    <div class="project-meta">
                        <span id="projectClient"></span>
                        <span id="projectPeriod"></span>
                        <span class="project-status" id="projectStatus"></span>
                    </div>
                </div>
                
                <!-- é€²æ—ã‚µãƒãƒªãƒ¼ -->
                <div class="progress-summary">
                    <div class="progress-card">
                        <div class="progress-number" id="totalTasks">0</div>
                        <div class="progress-label">ç·ã‚¿ã‚¹ã‚¯æ•°</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number" id="completedTasks">0</div>
                        <div class="progress-label">å®Œäº†æ¸ˆã¿</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number" id="inProgressTasks">0</div>
                        <div class="progress-label">é€²è¡Œä¸­</div>
                    </div>
                    <div class="progress-card">
                        <div class="progress-number danger" id="overdueTasks">0</div>
                        <div class="progress-label">é…å»¶</div>
                    </div>
                </div>
                
                <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ -->
                <div class="overall-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <span class="progress-text" id="progressText">0%</span>
                </div>
            </section>

            <!-- ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚¨ãƒªã‚¢ -->
            <section class="task-section" id="taskSection" style="display: none;">
                <div class="task-filters">
                    <button class="filter-btn active" data-phase="all">ã™ã¹ã¦</button>
                    <button class="filter-btn" data-phase="ãƒ•ã‚§ãƒ¼ã‚º1">ãƒ•ã‚§ãƒ¼ã‚º1</button>
                    <button class="filter-btn" data-phase="ãƒ•ã‚§ãƒ¼ã‚º2">ãƒ•ã‚§ãƒ¼ã‚º2</button>
                    <button class="filter-btn" data-phase="ãƒ•ã‚§ãƒ¼ã‚º3">ãƒ•ã‚§ãƒ¼ã‚º3</button>
                </div>

                <!-- ãƒ•ã‚§ãƒ¼ã‚ºã‚³ãƒ³ãƒ†ãƒŠã¯JavaScriptã§å‹•çš„ç”Ÿæˆ -->
            </section>
        </main>
    </div>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ«: æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ -->
    <div class="modal-overlay" id="newProjectModal">
        <div class="modal">
            <div class="modal-header">
                <h3>æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</h3>
                <button class="modal-close" id="closeNewProjectModal">&times;</button>
            </div>
            <form id="newProjectForm">
                <div class="form-group">
                    <label for="projectNameInput">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå *</label>
                    <input type="text" id="projectNameInput" required>
                </div>
                <div class="form-group">
                    <label for="projectCodeInput">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚³ãƒ¼ãƒ‰</label>
                    <input type="text" id="projectCodeInput" placeholder="ä¾‹: RD2024-001">
                </div>
                <div class="form-group">
                    <label for="clientNameInput">ç™ºæ³¨è€…å</label>
                    <input type="text" id="clientNameInput">
                </div>
                <div class="form-group">
                    <label for="descriptionInput">æ¦‚è¦</label>
                    <textarea id="descriptionInput" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="startDateInput">é–‹å§‹äºˆå®šæ—¥</label>
                        <input type="date" id="startDateInput">
                    </div>
                    <div class="form-group">
                        <label for="endDateInput">å®Œäº†äºˆå®šæ—¥</label>
                        <input type="date" id="endDateInput">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancelNewProject">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    <button type="submit" class="btn btn-primary">ä½œæˆ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ«: ã‚¿ã‚¹ã‚¯è©³ç´° -->
    <div class="modal-overlay" id="taskModal">
        <div class="modal task-modal">
            <div class="modal-header">
                <h3 id="taskModalTitle"></h3>
                <button class="modal-close" id="closeTaskModal">&times;</button>
            </div>
            <div class="task-modal-content">
                <div class="task-info">
                    <div class="task-status-selector">
                        <label>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</label>
                        <select id="taskStatusSelect">
                            <option value="not_started">æœªç€æ‰‹</option>
                            <option value="in_progress">é€²è¡Œä¸­</option>
                            <option value="completed">å®Œäº†</option>
                            <option value="not_applicable">å¯¾è±¡å¤–</option>
                        </select>
                    </div>
                    
                    <div class="task-assignment">
                        <label>æ‹…å½“è€…:</label>
                        <select id="taskAssigneeSelect">
                            <option value="">æœªå‰²å½“</option>
                        </select>
                    </div>
                    
                    <div class="task-date">
                        <label>äºˆå®šæ—¥:</label>
                        <input type="date" id="taskPlannedDate">
                    </div>
                    
                    <div class="task-meta">
                        <div class="task-meta-item">
                            <span class="meta-label">æŠ€è¡“è€…ä½œæ¥­:</span>
                            <span id="taskTechnical"></span>
                        </div>
                        <div class="task-meta-item">
                            <span class="meta-label">ãƒãƒ‹ãƒ¥ã‚¢ãƒ«:</span>
                            <span id="taskManual"></span>
                        </div>
                    </div>
                </div>
                
                <div class="task-notes">
                    <label>ä½œæ¥­ãƒ¡ãƒ¢:</label>
                    <textarea id="taskNotesInput" rows="4" placeholder="ä½œæ¥­ã«é–¢ã™ã‚‹ãƒ¡ãƒ¢ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancelTaskEdit">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    <button type="button" class="btn btn-primary" id="saveTaskChanges">ä¿å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">èª­ã¿è¾¼ã¿ä¸­...</div>
    </div>

    <script src="assets/js/main.js"></script>
    <script>
        console.log('HTML script tag executed');

        // JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ç¢ºèª
        function checkJavaScriptLoad() {
            console.log('Checking JavaScript status...');

            if (typeof RoadDesignApp === 'function') {
                console.log('âœ“ RoadDesignApp class is available');
            } else {
                console.error('âœ— RoadDesignApp class not found');
            }

            if (window.roadDesignApp) {
                console.log('âœ“ RoadDesignApp instance exists');
            } else {
                console.log('âœ— RoadDesignApp instance not found');
            }

            // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã®ç¢ºèª
            if (typeof debugRoadDesign === 'function') {
                console.log('âœ“ debugRoadDesign function is available');
            } else {
                console.error('âœ— debugRoadDesign function not found');
            }

            if (typeof goToAdmin === 'function') {
                console.log('âœ“ goToAdmin function is available');
            } else {
                console.error('âœ— goToAdmin function not found');
            }

            // ãƒœã‚¿ãƒ³ã®å­˜åœ¨ç¢ºèªã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
            const debugBtn = document.getElementById('settingsLink');
            const adminBtn = null;
            const directAdminBtn = null;

            console.log('Settings link element:', debugBtn);

            // ãƒ‡ãƒãƒƒã‚°ãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
            // aè¦ç´ ã§ç›´æ¥é·ç§»ã™ã‚‹ãŸã‚è¿½åŠ ã‚¤ãƒ™ãƒ³ãƒˆã¯ä¸è¦
        }

        // DOMãŒå®Œå…¨ã«èª­ã¿è¾¼ã¾ã‚ŒãŸå¾Œã«ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', checkJavaScriptLoad);
        } else {
            checkJavaScriptLoad();
        }

        // è¿½åŠ ã®ãƒã‚§ãƒƒã‚¯ï¼ˆå¿µã®ãŸã‚ï¼‰
        setTimeout(checkJavaScriptLoad, 1000);
        setTimeout(checkJavaScriptLoad, 3000);
    </script>
</body>
</html>